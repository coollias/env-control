<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配置客户端测试界面</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .content {
            padding: 20px;
        }
        .status-card {
            margin-bottom: 20px;
        }
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .config-section {
            border: 1px solid #e4e7ed;
            border-radius: 4px;
            padding: 15px;
        }
        .config-section h3 {
            margin-top: 0;
            color: #303133;
            border-bottom: 2px solid #409eff;
            padding-bottom: 8px;
        }
        .config-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .config-item:last-child {
            border-bottom: none;
        }
        .config-key {
            font-weight: 500;
            color: #606266;
        }
        .config-value {
            color: #409eff;
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
        }
        .refresh-btn {
            margin-bottom: 15px;
        }
        .log-container {
            max-height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            border: 1px solid #e4e7ed;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        .log-time {
            color: #909399;
        }
        .log-info {
            color: #409eff;
        }
        .log-success {
            color: #67c23a;
        }
        .log-error {
            color: #f56c6c;
        }
        .log-warning {
            color: #e6a23c;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .metric-card {
            background: #f8f9fa;
            border: 1px solid #e4e7ed;
            border-radius: 4px;
            padding: 15px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #409eff;
        }
        .metric-label {
            color: #606266;
            font-size: 12px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <div class="header">
                <h1>配置客户端测试界面</h1>
                <p>实时监控配置读取和变化情况</p>
            </div>
            
            <div class="content">
                <!-- 状态卡片 -->
                <el-card class="status-card">
                    <div slot="header">
                        <span>客户端状态</span>
                        <el-button style="float: right; padding: 3px 0" type="text" @click="refreshStatus">
                            <i class="el-icon-refresh"></i>
                        </el-button>
                    </div>
                    <el-row :gutter="20">
                        <el-col :span="6">
                            <div class="metric-card">
                                <div class="metric-value">{{ clientStatus.running ? '运行中' : '已停止' }}</div>
                                <div class="metric-label">客户端状态</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="metric-card">
                                <div class="metric-value">{{ clientStatus.lastUpdateTime || '未更新' }}</div>
                                <div class="metric-label">最后更新时间</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="metric-card">
                                <div class="metric-value">{{ clientStatus.configCount || 0 }}</div>
                                <div class="metric-label">配置项数量</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="metric-card">
                                <div class="metric-value">{{ clientStatus.version || '未知' }}</div>
                                <div class="metric-label">配置版本</div>
                            </div>
                        </el-col>
                    </el-row>
                </el-card>

                <!-- 操作按钮 -->
                <el-card style="margin-bottom: 20px;">
                    <div slot="header">
                        <span>操作控制</span>
                    </div>
                    <el-button-group>
                        <el-button type="primary" @click="refreshConfig" :loading="loading.refresh">
                            <i class="el-icon-refresh"></i> 刷新配置
                        </el-button>
                        <el-button type="success" @click="startClient" :loading="loading.start">
                            <i class="el-icon-video-play"></i> 启动客户端
                        </el-button>
                        <el-button type="warning" @click="stopClient" :loading="loading.stop">
                            <i class="el-icon-video-pause"></i> 停止客户端
                        </el-button>
                        <el-button type="info" @click="getHealth" :loading="loading.health">
                            <i class="el-icon-view"></i> 健康检查
                        </el-button>
                    </el-button-group>
                </el-card>

                <!-- 配置展示 -->
                <div class="config-grid">
                    <!-- 所有配置 -->
                    <div class="config-section">
                        <h3>所有配置项</h3>
                        <el-button size="small" @click="getAllConfigs" :loading="loading.allConfigs">
                            获取所有配置
                        </el-button>
                        <div style="margin-top: 10px;">
                            <div v-for="(value, key) in allConfigs" :key="key" class="config-item">
                                <span class="config-key">{{ key }}</span>
                                <span class="config-value">{{ value }}</span>
                            </div>
                            <div v-if="Object.keys(allConfigs).length === 0" style="color: #909399; text-align: center; padding: 20px;">
                                暂无配置数据
                            </div>
                        </div>
                    </div>

                    <!-- 业务配置 -->
                    <div class="config-section">
                        <h3>业务配置</h3>
                        <el-button size="small" @click="getBusinessConfig" :loading="loading.businessConfig">
                            获取业务配置
                        </el-button>
                        <div style="margin-top: 10px;">
                            <div v-for="(value, key) in businessConfig" :key="key" class="config-item">
                                <span class="config-key">{{ key }}</span>
                                <span class="config-value">{{ value }}</span>
                            </div>
                            <div v-if="Object.keys(businessConfig).length === 0" style="color: #909399; text-align: center; padding: 20px;">
                                暂无业务配置
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 监控指标 -->
                <el-card style="margin-bottom: 20px;">
                    <div slot="header">
                        <span>监控指标</span>
                        <el-button style="float: right; padding: 3px 0" type="text" @click="getMetrics">
                            <i class="el-icon-refresh"></i>
                        </el-button>
                    </div>
                    <div class="metrics-grid">
                        <div class="metric-card" v-for="(value, key) in metrics" :key="key">
                            <div class="metric-value">{{ value }}</div>
                            <div class="metric-label">{{ key }}</div>
                        </div>
                    </div>
                </el-card>

                <!-- 缓存信息 -->
                <el-card style="margin-bottom: 20px;">
                    <div slot="header">
                        <span>缓存信息</span>
                        <el-button style="float: right; padding: 3px 0" type="text" @click="getCacheInfo">
                            <i class="el-icon-refresh"></i>
                        </el-button>
                    </div>
                    <el-descriptions :column="3" border>
                        <el-descriptions-item label="缓存大小">{{ cacheInfo.cacheSize || 0 }}</el-descriptions-item>
                        <el-descriptions-item label="最后更新时间">{{ cacheInfo.lastUpdateTime || '未知' }}</el-descriptions-item>
                        <el-descriptions-item label="配置版本">{{ cacheInfo.version || '未知' }}</el-descriptions-item>
                    </el-descriptions>
                </el-card>

                <!-- 实时日志 -->
                <el-card>
                    <div slot="header">
                        <span>实时日志</span>
                        <el-button style="float: right; padding: 3px 0" type="text" @click="clearLogs">
                            清空日志
                        </el-button>
                    </div>
                    <div class="log-container">
                        <div v-for="(log, index) in logs" :key="index" class="log-entry">
                            <span class="log-time">[{{ log.time }}]</span>
                            <span :class="'log-' + log.type">{{ log.message }}</span>
                        </div>
                        <div v-if="logs.length === 0" style="color: #909399; text-align: center; padding: 20px;">
                            暂无日志
                        </div>
                    </div>
                </el-card>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="app.js"></script>
</body>
</html> 